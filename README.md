# Pose-Refinement-with-Predicted-3D-Model
This project aims to get a precise pose from an initial pose with predicted 3d model generated by [One-2-3-45++](http://sudo.ai/3dgen).
The pipeline is as follow:
1. Get images of different views from ground truth 3d model.(Obtained from Objaverse, Sketchfeb)
2. Use one of the images to get the predicted 3d model from [One-2-3-45++](http://sudo.ai/3dgen).
3. Use the predicted model and an image rendered from the ground truth model(with the initial coarse pose) to get a precise pose of the image.

We use Pytorch3d as the framework. 

First, we try to refine the pose from the ground truth model to the ground truth model.(or from predicted model to the predicted model)
The silhouette render is effective for this problem. We can use the silhoutte render, and take the loss as the MSE loss between the alpha channels of the initial image and the target image to optimize the pose(where the initial image is the image rendered with the initial coarse pose, and the target image is the image rendered with the target pose). Since only the alpha channel works for the optimization, texture of the 3d model is not needed. Therefore, we refine the pose based on the 3d model without texture.

Here is an example:
The ground truth model is:
![rgb_0006](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/fc9e7697-bf34-4dd4-b5e3-138a43563715)
![rgb_0005](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/88cba9a8-e7dd-4e72-a62c-3db7363a9693)
![rgb_0004](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/8b54333b-8268-4a83-acff-570e879d09c5)
![rgb_0003](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/92988530-9517-40bb-88ae-827ebd0344e9)
![rgb_0002](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/fd8f1a6e-d943-4502-abe3-e344fe92fba3)
![rgb_0001](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/c21e8de1-ac0d-4433-97f5-951b0210d837)
![rgb_0000](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/8ba9f775-b893-47d7-bd85-a38c10d87b4e)

The predicted model is:


The initial image:
![initial_pre_gray](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/fafea8a6-25c5-43bc-a070-dea8e75fa677)
The target image:
![target_gt_gray](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/2f5801ec-07c1-44c1-9e15-c5ddd08f21b9)

The refinement process is visualized as:
![siholette_demo](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/1317faea-32e1-4608-9bf5-2d7b09ff00ed)



![pre_0 2_nofeature](https://github.com/bobojiang26/Pose-Refinement-with-Predicted-3D-Model/assets/91231457/8bbe467d-34b0-4910-bf7b-bfd31116591d)
